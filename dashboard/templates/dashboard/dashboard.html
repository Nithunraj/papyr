
{% extends 'layout.html' %}
{% load static %}     
<!-- END OF SIDEBAR -------------------- -->
{% block content %}
<main>
<div class="topMenu">
    <h2 id="date-display"></h2>
</div>
<section id="balance">
    <h2 class="sr-only">Balance</h2>
    <div class="card">
        <h3>
            <span>Incomes</span>
            <img src="{% static 'assets/incomes.svg' %}" alt="Income image" />
        </h3>
        <p id="incomeDisplay">{{ income_total }}</p>
        <p id="dateDisplay"></p>
    </div>
    <div class="card">
        <h3>
            <span>Expenses</span>
            <img src="{% static 'assets/expenses.svg' %}" alt="Expense image" />
        </h3>
        <p id="expenseDisplay">{{ expense_total }}</p>
    </div>
    <div class="card total">
        <h3>
            <span>Balance</span>
            <img class="total" src="{% static 'assets/total.svg' %}" alt="Imagem de total" />
        </h3>
        <p id="totalDisplay">{{ balance }}</p>
    </div>
</section>
<!--END OF BALANCED SECTION-------------------- -->
<section id="transaction">
    <h2 class="sr-only">Transactions</h2>
    <div class="last-transactions">
        <div class="table-top">
            <h2>Last Transactions</h2>
            <button
            href="#"
            id="newTransaction"
            class="button new"
            onclick="Modal.open()"
            >
            + New Transaction
            </button>
        </div>
        <div class="table-container">
            <table id="data-table">
            <thead>
                <tr>
                    <th>S.No</th>
                    <th>Category</th>
                    <th>Wallet</th>
                    <th>Amount</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for v in transactions %}
                <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ v.category.name }}</td>
                <td>{{ v.wallet.name }}</td>
                <td>
                    {% if v.transaction_type == "income" %}
                        <span class="income">+ ₹{{ v.amount }}</span>
                    {% else %}
                        <span class="expense">- ₹{{ v.amount }}</span>
                    {% endif %}
                </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No transactions found</td>
                </tr>
                {% endfor %}
            </tbody>
            </table>
        </div>
    </div>
</section>
<!--END OF TRANSACTION SECTION-------------------- -->
<div class="addTransactionMobileButton">
    <button href="#" id="newTransactionMobile" onclick="Modal.open()">
    <span class="material-icons">add</span>
    </button>
</div>
</main>
<div class="right">
<div class="top">
    <button id="menu-btn">
    <span
        class="material-icons"
        id="mobile-menu"
        onclick="MobileMenu.open()"
        >menu</span
        >
    </button>
    <div class="theme-toggler">
        <span
            class="material-icons active"
            id="toggle-light"
            onclick="ThemeToggler.Light()"
            >light_mode</span
            >
        <span
            class="material-icons"
            id="toggle-dark"
            onclick="ThemeToggler.Dark()"
            >dark_mode</span
            >
    </div>
</div>
<div class="analytics">
    <h3>Chart | Balance</h3>
    <div>
        <canvas id="myChart"></canvas>
    </div>
</div>
</div>
<!--END OF RIGHT - theme-toggler - menu-btn - balance chart -------------------- -->
</div>
<div class="modal-overlay" id="modalOverlay">
<div class="modal">
<div id="form">
    <div class="modalTop">
        <h2>New Transaction</h2>
        <span
            class="material-icons"
            id="close-modal-btn"
            onclick="Modal.close()"
            >close</span
            >
    </div>
    <form action="{% url 'add_transactions' %}" method="post">
        {% csrf_token %}
        <div class="drop-down-wallet-categories">
            <div>
                <label class="sr-only" for="wallet">Wallet</label>
                <select class="drop-down-wallet" id="wallet" name="wallet" required>
                    <option value="">Select Wallet</option>
                    {% for w in wallets %}
                        <option value="{{ w.id }}">{{ w.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label class="sr-only" for="category">Category</label>
                <select class="drop-down-categories" id="category" name="category" required>
                    <option value="">Select Category</option>
                    {% for c in categories %}
                        <option value="{{ c.id }}" data-type="{{ c.type }}">
                            {{ c.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
        </div>
        <div class="input-group">
            <label class="sr-only" for="description">Description</label>
            <input
            type="text"
            id="description"
            name="description"
            placeholder="Description"
            />
        </div>
        <div class="input-group">
            <label class="sr-only" for="amount">Amount</label>
            <input
            type="number"
            id="amount"
            name="amount"
            step="0.01"
            placeholder="0.00"
            />
            <small class="help"
            >Select "Income" to incomes and "Expense" to expenses</small
            >
        </div>
        <input type="hidden" name="transaction_type" id="transaction_type"  value="income">
        <div class="buttons-income-expense">
            <button
            id="incomeButton"
            onclick="Form.setIncome();  return false;"
            class="income"
            name="transaction_type">
            Income
            </button>
            <button
            id="expenseButton"
            onclick="Form.setExpense(); return false;"
            name="transaction_type">
            Expense
            </button>
        </div>
        <div class="input-group">
            <label class="sr-only" for="date">Date</label>
            <input type="date" id="date" name="transaction_date" />
        </div>
        <div class="actions">
            <!-- <a href="#" id="cancelTransaction" class="button cancel" onclick="Modal.close()">Cancelar</a> -->
            <button class="save" type="submit">Confirm</button>
        </div>
    </form>
</div>
</div>
{% endblock %}